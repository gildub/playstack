---
# Global
#control_public: "%{ipaddress_eth1}"
#control_internal: "%{ipaddress_eth2}"
#control_admin: "%{ipaddress_eth3}"

control_public: 192.168.96.11
control_internal: 192.168.96.11
control_admin: 192.168.96.11

bridge_uplink: 'br-ex:eth4'

# Provide ip for idempotency
local_ip: 192.168.99.10

mysql::server::root_password: "%{hiera('dbms_root_password')}"
mysql::server::override_options:
  mysqld:
    bind-address: 0.0.0.0
#    bind-address: "%{hiera('control_internal')}"
    default_storage_engine: InnoDB

# Modules classes
glance::api::keystone_password: "%{hiera('glance_password')}"

glance::api::identity_uri: "http://%{hiera('control_internal')}:35357/v2.0"
glance::api::host_uri: "http://%{hiera('control_public')}:5000"
#glance::api::auth_host: "%{hiera('control_internal')}"
glance::api::bind_host: 0.0.0.0
#glance::api::bind_host: "%{hiera('control_admin')}"

glance::api::database_connection: "mysql://glance:%{hiera('glance_password')}@%{hiera('control_internal')}/glance"
glance::api::workers: 1
glance::api::registry_host: "%{hiera('control_public')}"

glance::registry::keystone_password: "%{hiera('glance_password')}"

glance::registry::bind_host: "%{hiera('control_admin')}"

glance::api::host_uri: "http://%{hiera('control_internal')}:5000"

glance::registry::auth_host: "%{hiera('control_public')}"
glance::registry::database_connection: "mysql://glance:%{hiera('glance_password')}@%{hiera('control_internal')}/glance"

glance::db::mysql::password: "%{hiera('glance_password')}"
glance::db::mysql::host: "%{hiera('control_internal')}"

glance::keystone::auth::password: "%{hiera('glance_password')}"
glance::keystone::auth::public_address: "%{hiera('control_public')}"
glance::keystone::auth::admin_address: "%{hiera('control_admin')}"
glance::keystone::auth::internal_address: "%{hiera('control_internal)}"

horizon::secret_key: horizon_secret_key
horizon::keystone_default_role: '_member_'
horizon::keystone_host: "%{hiera('control_public')}"
horizon::fqdn: [ "%{hiera('control_public')}", "%{fqdn}", "%{hostname}", 'localhost', '*']
#horizon::listen_ssl: false
#horizon::horizon_cert: horizon_cert
#horizon::horizon_key: horizon_key
#horizon::horizon_ca: horizon_ca
horizon::neutron_options: ''

keystone::admin_bind_host: 0.0.0.0
# keystone::admin_bind_host: "%{hiera('control_admin')}"
keystone::admin_token: "%{hiera('admin_token')}"
keystone::database_connection: "mysql://keystone:%{hiera('keystone_password')}@%{hiera('control_internal')}/keystone"
keystone::public_bind_host: "%{hiera('control_public')}"
keystone::debug: false
keystone::enable_ssl: false
#keystone::token_provider: "keystone.token.providers.XXXXXXXXXX.Provider"
keystone::verbose: true

keystone::db::mysql::password: "%{hiera('keystone_password')}"
keystone::db::mysql::host: "%{hiera('control_internal')}"
keystone::db::mysql::allowed_hosts: '%'

keystone::endpoint::public_url: "http://%{hiera('control_public')}:5000"
keystone::endpoint::admin_url: "http://%{hiera('control_admin')}:35357"
keystone::endpoint::internal_url: "http://%{hiera('control_internal')}:5000"

keystone::roles::admin::email: admin@example.com
keystone::roles::admin::password: "%{hiera('admin_password')}"
keystone::roles::admin::admin_tenant: admin

neutron::bind_host: "%{hiera('control_public')}"
neutron::core_plugin: neutron.plugins.ml2.plugin.Ml2Plugin
neutron::rabbit_password: "%{hiera('rabbitmq_password')}"
neutron::service_plugins:
  - neutron.services.l3_router.l3_router_plugin.L3RouterPlugin
neutron::rabbit_host: "%{hiera('control_internal')}"

neutron::server::sync_db: true
#neutron::server::auth_host: "%{hiera('control_public')}"
neutron::server::identity_uri: "http://%{hiera('control_internal')}:35357/v2.0"
neutron::server::host_uri: "http://%{hiera('control_internal')}:5000"
neutron::server::database_connection: "mysql://neutron:%{hiera('neutron_password')}@%{hiera('control_internal')}/neutron"
neutron::server::auth_password: "%{hiera('neutron_password')}"

neutron::server::notifications::notify_nova_on_port_status_changes: true
neutron::server::notifications::notify_nova_on_port_data_changes: true
neutron::server::notifications::nova_admin_auth_url: "http://%{hiera('control_admin')}:35357/v2.0"
neutron::server::notifications::nova_url: "http://%{hiera('control_public')}:8774/v2"
neutron::server::notifications::nova_admin_username: nova
neutron::server::notifications::nova_admin_password: "%{hiera('nova_password')}"

neutron::agents::metadata::auth_password: "%{hiera('neutron_password')}"
neutron::agents::metadata::shared_secret: "%{hiera('neutron_metadata_shared_secret')}"
neutron::agents::metadata::auth_url: "http://%{hiera('control_public')}:35357/v2.0"
neutron::agents::metadata::metadata_ip: "%{hiera('control_public')}"

neutron::agents::ml2::ovs::bridge_uplinks:
  - "%{hiera('bridge_uplink')}"
neutron::agents::ml2::ovs::bridge_mappings:
  - 'default:br-ex'
neutron::agents::ml2::ovs::local_ip: "%{hiera('local_ip')}"
neutron::agents::ml2::ovs::enable_tunneling: true
neutron::agents::ml2::ovs::tunnel_types:
  - gre
neutron::plugins::ml2::type_drivers:
  - gre
neutron::plugins::ml2::tenant_network_types:
  - gre
neutron::plugins::ml2::mechanism_drivers:
  - openvswitch

neutron::db::mysql::password: "%{hiera('neutron_password')}"
neutron::db::mysql::host: "%{hiera('control_internal')}"

neutron::keystone::auth::password: "%{hiera('neutron_password')}"
neutron::keystone::auth::public_address: "%{hiera('control_public')}"
neutron::keystone::auth::admin_address: "%{hiera('control_admin')}"
neutron::keystone::auth::internal_address: "%{hiera('control_internal')}"

nova::database_connection: "mysql://nova:%{hiera('nova_password')}@%{hiera('control_internal')}/nova"
nova::debug: true
nova::glance_api_servers: "%{hiera('control_public')}:9292"
nova::rabbit_host: "%{hiera('control_internal')}"
nova::rabbit_host: hiera('CONFIG_AMQP_HOST')
nova::rabbit_use_ssl: false
nova::rabbit_userid: hiera('CONFIG_AMQP_AUTH_USER')
nova::rabbit_password: hiera('CONFIG_AMQP_AUTH_PASSWORD')
nova::verbose: true
#nova::nova_public_key: $public_key
#nova::nova_private_key: $private_key

nova::api::admin_password: "%{hiera('nova_password')}"
nova::api::enabled: true
nova::api::identity_uri: "http://%{hiera('control_admin')}:35357/v2.0"
nova::api::host_uri: "http://%{hiera('control_public')}:5000"
nova::api::api_bind_address: 0.0.0.0
#nova::api::api_bind_address: "%{hiera('control_public')}"
nova::api::metadata_listen: "%{hiera('control_public')}"
#nova::api::auth_host: ''
nova::api::neutron_metadata_proxy_shared_secret: "%{hiera('neutron_metadata_shared_secret')}"

nova::compute::enabled: true
nova::compute::libvirt::libvirt_virt_type: qemu

nova::conductor::enabled: true

nova::db::mysql::password: "%{hiera('nova_password')}"
nova::db::mysql::host: "%{hiera('control_internal')}"

nova::keystone::auth::password: "%{hiera('nova_password')}"
nova::keystone::auth::public_address: "%{hiera('control_public')}"
nova::keystone::auth::admin_address: "%{hiera('control_admin')}"
nova::keystone::auth::internal_address: "%{hiera('control_internal')}"

nova::network::neutron::neutron_admin_password: "%{hiera('neutron_password')}"
nova::network::neutron::neutron_url: "http://%{hiera('control_public')}:9696"
nova::network::neutron::neutron_admin_auth_url: "http://%{hiera('control_public')}:35357/v2.0"
#nova::network::neutron::vif_plugging_is_fatal: false
#nova::network::neutron::vif_plugging_timeout: 0

nova::scheduler::enabled: true

rabbitmq::node_ip_address: "%{hiera('control_admin')}"
rabbitmq::repos_ensure: false
rabbitmq::ssl: false
